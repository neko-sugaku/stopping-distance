<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è»Šã®åœæ­¢è·é›¢ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+1p:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'M PLUS 1p', sans-serif;
        }
        .result-bar-container {
            display: flex;
            width: 100%;
            height: 40px;
            border-radius: 0.5rem;
            overflow: hidden;
            background-color: #374151;
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.2);
        }
        .result-bar {
            transition: width 0.3s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.875rem;
            white-space: nowrap;
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex items-center justify-center p-4">
    <div class="w-full max-w-4xl mx-auto">
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 via-red-500 to-pink-500">åœæ­¢è·é›¢ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
            <p class="mt-2 text-gray-300">ã€Œã‚ã£ï¼ã€ã¨æ€ã£ã¦ã‹ã‚‰ã€è»ŠãŒå®Œå…¨ã«æ­¢ã¾ã‚‹ã¾ã§ã®è·é›¢ã¯ï¼Ÿ</p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- å…¥åŠ›ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="bg-gray-800 p-6 rounded-2xl shadow-2xl">
                <h2 class="text-2xl font-bold mb-6 border-b-2 border-yellow-400 pb-2">æ¡ä»¶ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</h2>

                <!-- é€Ÿåº¦ -->
                <div class="mb-6">
                    <label for="speed" class="block mb-2 font-bold text-lg">
                        <span class="text-yellow-400">â‘ </span> è»Šã®é€Ÿåº¦ (km/h)
                    </label>
                    <div class="flex items-center space-x-4">
                        <input type="range" id="speed-slider" min="0" max="200" value="40" class="w-full h-3 bg-gray-700 rounded-lg appearance-none cursor-pointer range-lg">
                        <input type="number" id="speed-input" min="0" max="200" value="40" class="w-24 bg-gray-700 text-white font-bold text-center rounded-lg p-2">
                    </div>
                </div>

                <!-- åå¿œæ™‚é–“ -->
                <div class="mb-6">
                    <label for="reaction" class="block mb-2 font-bold text-lg">
                        <span class="text-yellow-400">â‘¡</span> åå¿œæ™‚é–“ (ç§’)
                    </label>
                    <div class="flex items-center space-x-4">
                        <input type="range" id="reaction-slider" min="0.1" max="2.0" step="0.1" value="1.0" class="w-full h-3 bg-gray-700 rounded-lg appearance-none cursor-pointer range-lg">
                        <input type="number" id="reaction-input" min="0.1" max="2.0" step="0.1" value="1.0" class="w-24 bg-gray-700 text-white font-bold text-center rounded-lg p-2">
                    </div>
                    <p class="text-sm text-gray-400 mt-2">â€»å±é™ºã‚’å¯ŸçŸ¥ã—ã¦ã‹ã‚‰ãƒ–ãƒ¬ãƒ¼ã‚­ã‚’è¸ã‚€ã¾ã§ã®æ™‚é–“ã€‚ä¸€èˆ¬çš„ã«ã¯0.75ç§’ã€œ1ç§’ã§ã™ã€‚</p>
                </div>

                <!-- è·¯é¢çŠ¶æ³ -->
                <div>
                    <label for="surface" class="block mb-2 font-bold text-lg">
                        <span class="text-yellow-400">â‘¢</span> è·¯é¢çŠ¶æ³
                    </label>
                    <select id="surface" class="w-full bg-gray-700 text-white rounded-lg p-3 cursor-pointer">
                        <option value="0.8">ä¹¾ã„ãŸé“è·¯ (ã‚¢ã‚¹ãƒ•ã‚¡ãƒ«ãƒˆ)</option>
                        <option value="0.6">æ¿¡ã‚ŒãŸé“è·¯ (é›¨)</option>
                        <option value="0.4">ç ‚åˆ©é“</option>
                        <option value="0.25">é›ªé“</option>
                        <option value="0.1">å‡çµã—ãŸé“è·¯ (ã‚¢ã‚¤ã‚¹ãƒãƒ¼ãƒ³)</option>
                    </select>
                </div>
            </div>

            <!-- çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="bg-gray-800 p-6 rounded-2xl shadow-2xl flex flex-col justify-between">
                <div>
                    <h2 class="text-2xl font-bold mb-4 border-b-2 border-red-500 pb-2">è¨ˆç®—çµæœ</h2>
                    
                    <div class="space-y-4">
                        <div>
                            <span class="font-bold text-blue-400">ç©ºèµ°è·é›¢:</span>
                            <span id="thinking-distance" class="text-2xl font-bold ml-2">0.0 m</span>
                        </div>
                        <div>
                            <span class="font-bold text-red-400">åˆ¶å‹•è·é›¢:</span>
                            <span id="braking-distance" class="text-2xl font-bold ml-2">0.0 m</span>
                        </div>
                        <div class="border-t border-gray-600 pt-4 mt-4">
                            <span class="font-bold text-xl text-yellow-400">åœæ­¢è·é›¢:</span>
                            <span id="stopping-distance" class="text-5xl font-black ml-2">0.0 m</span>
                        </div>
                    </div>

                    <div class="mt-6">
                        <h3 class="font-bold mb-2">è·é›¢ã®å†…è¨³:</h3>
                        <div class="result-bar-container">
                            <div id="thinking-bar" class="result-bar bg-blue-500"></div>
                            <div id="braking-bar" class="result-bar bg-red-500"></div>
                        </div>
                         <div class="flex justify-between text-xs mt-1 text-gray-400">
                            <span>ç©ºèµ°</span>
                            <span>åˆ¶å‹•</span>
                        </div>
                    </div>
                </div>

                <div id="comment-box" class="mt-8 text-center bg-gray-900 p-4 rounded-lg border-2 border-dashed border-gray-600 transition-all duration-300">
                    <p id="comment-example" class="text-xl font-bold text-yellow-300"></p>
                    <p id="comment-text" class="text-md text-gray-300 mt-1"></p>
                </div>
            </div>
        </main>
    </div>

    <script>
        // DOMè¦ç´ ã®å–å¾—
        const speedSlider = document.getElementById('speed-slider');
        const speedInput = document.getElementById('speed-input');
        const reactionSlider = document.getElementById('reaction-slider');
        const reactionInput = document.getElementById('reaction-input');
        const surfaceSelect = document.getElementById('surface');

        const thinkingDistEl = document.getElementById('thinking-distance');
        const brakingDistEl = document.getElementById('braking-distance');
        const stoppingDistEl = document.getElementById('stopping-distance');

        const thinkingBar = document.getElementById('thinking-bar');
        const brakingBar = document.getElementById('braking-bar');
        
        const commentExampleEl = document.getElementById('comment-example');
        const commentTextEl = document.getElementById('comment-text');

        // å®šæ•°
        const GRAVITY = 9.8;

        // ä¾‹ã¨ã‚³ãƒ¡ãƒ³ãƒˆã®ãƒªã‚¹ãƒˆ
        const comments = [
            { limit: 10, example: "ä¹—ç”¨è»Š ç´„2å°åˆ†ï¼", text: "æ€ã£ãŸã‚ˆã‚Šé€²ã‚€ã­ï¼" },
            { limit: 20, example: "ãƒœãƒ¼ãƒªãƒ³ã‚°ã®ãƒ¬ãƒ¼ãƒ³ãã‚‰ã„ï¼", text: "æ€¥ã«ã¯æ­¢ã¾ã‚Œãªã„ï¼" },
            { limit: 25, example: "25mãƒ—ãƒ¼ãƒ«ã¨åŒã˜ãã‚‰ã„ï¼", text: "æ­©è¡Œè€…ãŒã„ãŸã‚‰â€¦å±ãªã„ï¼" },
            { limit: 40, example: "è·¯ç·šãƒã‚¹ã¨åŒã˜ãã‚‰ã„ï¼", text: "ã“ã‚ŒãŒè¡—ä¸­ã ã¨æ€ã†ã¨æ€–ã„â€¦" },
            { limit: 60, example: "ã‚¸ãƒ£ãƒ³ãƒœã‚¸ã‚§ãƒƒãƒˆæ©Ÿã®ç¿¼å¹…ï¼", text: "ã‹ãªã‚Šã®è·é›¢ã ã‚ˆï¼" },
            { limit: 100, example: "ã‚µãƒƒã‚«ãƒ¼ã‚³ãƒ¼ãƒˆã®ç«¯ã‹ã‚‰ç«¯ã¾ã§ï¼", text: "ã‚‚ã†è‡ªåˆ†ã®åŠ›ã§ã¯ã©ã†ã«ã‚‚ã§ããªã„ï¼" },
            { limit: 150, example: "æ–°å¹¹ç·šã®è»Šä¸¡6ä¸¡åˆ†ï¼", text: "å®Œå…¨ã«åˆ¶å¾¡ä¸èƒ½ï¼" },
            { limit: 200, example: "50éšå»ºã¦ã®é«˜å±¤ãƒ“ãƒ«ï¼", text: "ã“ã‚Œã¯æœ¬å½“ã«ãƒã‚ºã„çŠ¶æ³ï¼" },
            { limit: 333, example: "æ±äº¬ã‚¿ãƒ¯ãƒ¼ãŒæ¨ªå€’ã—ã«ãªã£ãŸãã‚‰ã„ï¼", text: "ä¿¡ã˜ã‚‰ã‚Œãªã„ãã‚‰ã„å±é™ºï¼ï¼ï¼ğŸ’€" },
            { limit: Infinity, example: "æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼ã®åŠåˆ†ä»¥ä¸Šï¼", text: "çµ¶å¯¾ãƒ€ãƒ¡ï¼ï¼ï¼ğŸ˜±" }
        ];

        // è¨ˆç®—ã¨è¡¨ç¤ºæ›´æ–°ã‚’è¡Œã†é–¢æ•°
        function calculateAndDisplay() {
            // å…¥åŠ›å€¤ã®å–å¾—
            const speedKmh = parseFloat(speedInput.value);
            const reactionTime = parseFloat(reactionInput.value);
            const frictionCoeff = parseFloat(surfaceSelect.value);

            // æ™‚é€Ÿ(km/h)ã‚’ç§’é€Ÿ(m/s)ã«å¤‰æ›
            const speedMps = speedKmh / 3.6;

            // 1. ç©ºèµ°è·é›¢ã®è¨ˆç®—
            const thinkingDistance = speedMps * reactionTime;

            // 2. åˆ¶å‹•è·é›¢ã®è¨ˆç®—
            const brakingDistance = (speedMps ** 2) / (2 * frictionCoeff * GRAVITY);
            
            // 3. åœæ­¢è·é›¢ã®è¨ˆç®—
            const stoppingDistance = thinkingDistance + brakingDistance;

            // çµæœã®è¡¨ç¤º (æ•°å€¤)
            thinkingDistEl.textContent = `${thinkingDistance.toFixed(1)} m`;
            brakingDistEl.textContent = `${brakingDistance.toFixed(1)} m`;
            stoppingDistEl.textContent = `${stoppingDistance.toFixed(1)} m`;

            // çµæœã®è¡¨ç¤º (ãƒãƒ¼)
            const totalDistanceForBar = Math.max(stoppingDistance, 1); // 0é™¤ç®—ã‚’é¿ã‘ã‚‹
            const thinkingPercentage = (thinkingDistance / totalDistanceForBar) * 100;
            const brakingPercentage = (brakingDistance / totalDistanceForBar) * 100;

            thinkingBar.style.width = `${thinkingPercentage}%`;
            brakingBar.style.width = `${brakingPercentage}%`;
            
            // ãƒãƒ¼ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’è¡¨ç¤º
            if (thinkingPercentage > 10) thinkingBar.textContent = `${thinkingDistance.toFixed(1)}m`;
            else thinkingBar.textContent = '';
            if (brakingPercentage > 10) brakingBar.textContent = `${brakingDistance.toFixed(1)}m`;
            else brakingBar.textContent = '';


            // ã‚³ãƒ¡ãƒ³ãƒˆã®è¡¨ç¤º
            let displayed = false;
            for (const comment of comments) {
                if (stoppingDistance <= comment.limit) {
                    commentExampleEl.textContent = `ç´„ ${stoppingDistance.toFixed(0)}m ã¯â€¦ ${comment.example}`;
                    commentTextEl.textContent = comment.text;
                    displayed = true;
                    break;
                }
            }
            if (!displayed || stoppingDistance < 1) {
                 commentExampleEl.textContent = 'å®‰å…¨é‹è»¢ã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†';
                 commentTextEl.textContent = '';
            }
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        speedSlider.addEventListener('input', (e) => {
            speedInput.value = e.target.value;
            calculateAndDisplay();
        });
        speedInput.addEventListener('input', (e) => {
            speedSlider.value = e.target.value;
            calculateAndDisplay();
        });

        reactionSlider.addEventListener('input', (e) => {
            reactionInput.value = e.target.value;
            calculateAndDisplay();
        });
        reactionInput.addEventListener('input', (e) => {
            reactionSlider.value = e.target.value;
            calculateAndDisplay();
        });

        surfaceSelect.addEventListener('change', calculateAndDisplay);
        
        // åˆæœŸè¡¨ç¤º
        window.onload = calculateAndDisplay;
    </script>
</body>
</html>
